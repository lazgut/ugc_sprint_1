# Проектная работа 8 спринта

Проектные работы в этом модуле выполняются в командах по 3 человека. Процесс обучения аналогичен сервису, где вы изучали асинхронное программирование. Роли в команде и отправка работы на ревью не меняются.

Распределение по командам подготовит команда сопровождения. Куратор поделится с вами списками в Slack в канале #group_projects.

Задания на спринт вы найдёте внутри тем.

Link to the project: https://github.com/lazgut/ugc_sprint_1

## Результаты исследования производительности.

Были замерены Clickhouse и Vertica. В каждую вставлено по 30 млн. записей. По 
рекомендации из теории, в Clickhouse в качестве ключа использовалась конструкция 
{user_id}+{movie_id}, в Vertica user_id и movie_id были в разных колонках. В 
Vertica был создан projection, по user_id и movie_id. 

 ###  Вставка
 
 В Clickhouse скрипт вставки отработал быстро, около 40 секунд, но затем пошла
  долгая отложенная вставка. Проверяли по изменению SELECT COUNT(*) FROM ... . 
  30 млн вставлялись около 24 минут. В Vertica всё прошло куда быстрее, не более 
  минуты. Возможно, Vertica также долго вставляет в фоне, просто сразу выставляет 
  значение счетчика. 
 
 ### Чтение
 
Vertica. Запрос по movie_id=..., (неоптимальный по projection), занял 23 секунды. 
По user_id=..., предположительно оптимизированный по projection, около 0.2 с. 

Clickhouse. Запросы делались с использованием SQL-функций LEFT() и RIGHT(), для 
выделения user_id и movie_id соответственно. Первый можно считать оптимизированным, 
второй нет. Первый занял 0.8 секунды, второй 17 секунд. Результаты сравнимы, но 
Vertica всё же немного впереди. 

В целом Vertica оставляет впечатление более производительной. Clickhouse же более 
распространён, по нему проще найти примеры и статьи, поэтому выбор пал на него. 
