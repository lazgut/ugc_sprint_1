# Проектная работа 9 спринта

1. Протестировать скорость работы mongo, сравнивать можно с чем угодно, в том числе и с postgres
2. Доработать UGC API в части добавления закладок, лайков и рецензий.
3. Добавить Sentry в проект
4. Настроить работу ELK. Добавить логирование в проект.
5. Задание по CI/CD

Link to the project: https://github.com/dondublon/ugc_sprint_1-1

## Исследование

Сравнивали MongoDB c PogtreSQL.

Mongo вставляет миллион записей за 2 минуты 4 секунды. Postgres вставляет 1-й миллион на 2:04, 2-й за 2:19, залее вставка замедляется, 11-й, уже 26 минут, а 12-й - 1 час 12 минут. Вставка идёт батчами по 1000 записей в обоих случаях. 
Вывод - PosgtreSQL для таких объёмов явно непригоден, а MongoDB подходит.
Индексы. В MongoDB был создан неуникальный индекс, т. к. создание уникального приводит к зависанию системы. В PostgreSQL используется уникальный индекс, с применением ON CONFLICT.

## Sentry

Для подключения своего проекта Sentry необходимо в файл _.env_ внести значение для переменной _SENTRY_DSN_. Пример можно посмотреть в _.env.debug_

## ELK

Елка настроена для бэкенда в рамках текущего спринта - контейнер в docker-compose.yml **"backend"** (_tags='backend'_).
Также добавлено логирование логов из nginx - _tags='nginx'_
Конфиг для logstash находится в [./deploy/logstash.conf]()

## CI/CD

Настройки jobs лежат в [./.github/workflows/python.yml]()
Рассылка в Телеграм происходит при push и pull реквестах в ветку _main_, чтобы участники репозитария могли своевременно отслеживать внесенные обновления.
Добавлена проверка на совместимость с версиями python 3.10 и 3.11, проверка линтером flake8 (плагин wemake-python-styleguide) и проверка типов mypy.
Для flake8 и mypy добавлен общий конфиг [./setup.cfg]()